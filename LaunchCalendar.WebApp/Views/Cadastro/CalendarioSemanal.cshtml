@model LaunchCalendar.WebApp.ViewModels.CalendarioViewModel

@{
    ViewData["Title"] = "Calendário Semanal";
    var inicioSemana = Model?.InicioSemana ?? DateTime.Today;
    var filmes = Model?.Filmes ?? Enumerable.Empty<LaunchCalendar.Application.Queries.Filmes.FilmeQueryOutput>();
    var episodios = Model?.Episodios ?? Enumerable.Empty<LaunchCalendar.Application.Queries.Episodios.EpisodiosQueryOutput>();
    var series = Model?.Series ?? Enumerable.Empty<LaunchCalendar.Application.Queries.Series.SerieQueryOutput>();
    string[] diasSemana = new[] { "SEG", "TER", "QUA", "QUI", "SEX", "SÁB", "DOM" };

    var prevStart = inicioSemana.AddDays(-7).ToString("yyyy-MM-dd");
    var nextStart = inicioSemana.AddDays(7).ToString("yyyy-MM-dd");
}

<div class="calendar-container">
    <header class="calendar-header">
        <div class="title">
            <svg viewBox="0 0 24 24"><path d="M4 4h4v4H4zm6 0h4v4h-4zm6 0h4v4h-4zM4 10h4v4H4zm6 0h4v4h-4zm6 0h4v4h-4zM4 16h4v4H4zm6 1h4v2h-4zm6 0h4v4h-4z"></path></svg>
            <span>CALENDÁRIO DE LANÇAMENTOS</span>
        </div>
        <div class="season">
            <svg viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zM5 8V6h14v2H5z"></path></svg>
            <span>PROGRAMAÇÃO</span>
        </div>
    </header>

    <div class="schedule-grid-wrapper">
        <!-- previous week link -->
        <a class="nav-arrow left-arrow" href="@Url.Action("CalendarioSemanal", "Cadastro", new { start = prevStart })" aria-label="Semana anterior" title="Semana anterior">
            <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg>
        </a>

        <main class="schedule-grid" role="list">
            @for (int i = 0; i < 7; i++)
            {
                var dia = inicioSemana.AddDays(i).Date;
                <div class="day-column" role="listitem">
                    <header class="day-header">
                        <div class="date">@dia.ToString("dd/MM")</div>
                        <div class="day-name">@diasSemana[i]</div>
                    </header>
                    <ul class="schedule-list">
                        @* Filmes *@
                        @foreach (var f in filmes.Where(f => f.DataLancamento.Date == dia))
                        {
                            var hasImage = !string.IsNullOrWhiteSpace(f.ImagemExibicao);
                            <li class="schedule-item">
                                <div class="timeline" aria-hidden="true"></div>

                                <div class="item-card @(hasImage ? "" : "no-image")" role="article">
                                    <div class="item-card-body">
                                        <div class="title">@f.Titulo</div>
                                        <div class="subtitle">Filme - @f.Genero</div>
                                    </div>

@*                                     @if (hasImage)
                                    {
                                        <div class="item-image">
                                            <img src="@f.ImagemExibicao" alt="@f.Titulo" />
                                        </div>
                                    } *@
                                </div>
                            </li>
                        }

                        @* Episódios *@
                        @foreach (var ep in episodios.Where(e => e.DataLancamento.Date == dia))
                        {
                            var serieNome = series.FirstOrDefault(s => s.SerieId == ep.SerieId)?.Titulo ?? "Série";
                            var hasImageEp = !string.IsNullOrWhiteSpace(ep.ImagemExibicao);
                            <li class="schedule-item">
                                <div class="timeline" aria-hidden="true"></div>

                                <a href="@Url.Action("DetalharEpisodio", new { id = ep.EpisodioId })" class="item-card @(hasImageEp ? "" : "no-image")" role="article" style="text-decoration: none; color: inherit; cursor: pointer;">
                                    <div class="item-card-body">
                                        <div class="title">@serieNome</div>
                                        <div class="subtitle">Ep. @ep.Numero - @ep.Titulo</div>
                                    </div>

         @*                            @if (hasImageEp)
                                    {
                                        <div class="item-image">
                                            <img src="@ep.ImagemExibicao" alt="@ep.Titulo" />
                                        </div>
                                    } *@
                                </a>
                            </li>
                        }
                    </ul>
                </div>
            }
        </main>

        <!-- next week link -->
        <a class="nav-arrow right-arrow" href="@Url.Action("CalendarioSemanal", "Cadastro", new { start = nextStart })" aria-label="Próxima semana" title="Próxima semana">
            <svg viewBox="0 0 24 24"><path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"></path></svg>
        </a>
    </div>
</div>